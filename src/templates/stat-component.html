<div class="border-bottom">
  <p class="text-start badge text-bg-primary text-wrap fw-light">
    Plays: {{ song.plays }}, Comments: {{ song.comments }}, Id: {{ song.song_id
    }}
  </p>
  {% if song.user_id == session.user_id %}

  <form id="publicForm" action="/a?song_id={{song.song_id}}" method="POST">
    <input
      type="hidden"
      name="is_public_song"
      value="none"
      id="hiddenIsPublic"
    />
    <div class="form-check form-switch">
      <!-- prettier-ignore -->
      <input
        class="form-check-input"
        type="checkbox"
        role="switch"
        id="flexSwitchCheckChecked"
        name="is_public"
        onchange="sendChange()"
        {% if song.is_public %} checked {% endif %} 
      />
      <label class="form-check-label" for="flexSwitchCheckChecked"
        >Is public</label
      >
    </div>
  </form>
  <script>
    function sendChange() {
      const form = document.getElementById("publicForm");
      const hiddenInput = document.getElementById("hiddenIsPublic");
      const checkbox = document.getElementById("flexSwitchCheckChecked");

      hiddenInput.value = checkbox.checked ? "true" : "false";

      const formData = new FormData(form);

      fetch(form.action, {
        method: form.method,
        body: formData,
      })
        .then((response) => response.json())
        .then((data) => {
          console.log(data);
        })
        .catch((error) => {
          console.error("Error:", error);
        });
    }
  </script>

  {% endif %}
</div>
